/**
 * Global Styles with Accessibility Support
 */

/* Eliminate white edges - match header color so gaps blend in */
html,
body {
  margin: 0 !important;
  padding: 0 !important;
  width: 100%;
  min-height: 100vh;
  overflow-x: hidden;
  background-color: #0f172a !important; /* Match enterprise header */
}

#root {
  margin: 0 !important;
  padding: 0 !important;
  width: 100% !important;
  min-height: 100vh;
  background-color: #0f172a;
}

/* NO desktop-specific overrides - desktop should match web exactly */

/* Ketcher Canvas: Proper sizing - no margin (container handles header offset) */
.Ketcher-root,
.Ketcher-polymer-editor-root {
  height: 100% !important;
  max-height: 100% !important;
  display: flex !important;
  flex-direction: column !important;
  overflow: hidden !important;
}

/* Canvas area takes available space */
.Ketcher-root .canvas-container,
.Ketcher-root [class*="editor"],
.Ketcher-polymer-editor-root .canvas-container,
.Ketcher-polymer-editor-root [class*="editor"] {
  flex: 1 1 auto !important;
  min-height: 0 !important;
  overflow: auto !important;
}

/* Bottom toolbar stays at natural position - both modes */
.Ketcher-root [class*="bottom"],
.Ketcher-root [class*="Bottom"],
.Ketcher-polymer-editor-root [class*="bottom"],
.Ketcher-polymer-editor-root [class*="Bottom"] {
  flex: 0 0 auto !important;
}

/* Restore bottom toolbar after moleculesâ†”macromolecules switch.
   Ketcher bug: toolbar disappears when switching back to molecules. */
.Ketcher-root [data-testid="bottom-toolbar"],
.Ketcher-polymer-editor-root [data-testid="bottom-toolbar"] {
  display: flex !important;
  visibility: visible !important;
  opacity: 1 !important;
  min-height: 48px !important;
  flex: 0 0 auto !important;
  flex-shrink: 0 !important;
}

/* Fix: Ketcher mode dropdown (Molecules/Macromolecules) disappearing when opened.
   Overflow clips the dropdown; toolbar must not clip. Mode switcher uses MUI Popover (portals to body). */
.Ketcher-root [data-testid="top-toolbar"],
.Ketcher-polymer-editor-root [data-testid="top-toolbar"] {
  overflow: visible !important;
}

/* Fix: In RNA Builder mode, Ketcher disables the mode switcher (toggler-component-wrapper--disabled).
   User gets stuck - cannot switch back to Molecules. Re-enable it. */
.Ketcher-polymer-editor-root .toggler-component-wrapper--disabled {
  opacity: 1 !important;
  pointer-events: auto !important;
  cursor: pointer !important;
}
/* Make mode switcher visible in macromolecules - it collapses to 28px and is easy to miss */
.Ketcher-polymer-editor-root [data-testid="polymer-toggler"] {
  min-width: 90px !important;
}
/* MUI Popover for mode switcher - ensure high z-index above Chemical Info panel */
.MuiPopover-root:has([data-testid="molecules_mode"]) {
  z-index: 9999 !important;
}
.MuiPopover-root:has([data-testid="molecules_mode"]) .MuiPopover-paper {
  z-index: 10000 !important;
}

/* Fix: MUI Popover adds padding-right to body when open (scrollbar compensation), causing white space.
   Reserve scrollbar space so body doesn't need padding when popover opens. */
html {
  overflow-y: scroll;
}

/* Fix: Reduce big gap between Molecules dropdown and next toolbar buttons (gear, zoom, etc) */
.Ketcher-root [data-testid="top-toolbar"] > div:last-child,
.Ketcher-polymer-editor-root [data-testid="top-toolbar"] > div:last-child {
  gap: 4px !important;
}
/* Prevent flex-grow from creating excess space between toolbar items */
.Ketcher-root [data-testid="top-toolbar"] > div:last-child > *,
.Ketcher-polymer-editor-root [data-testid="top-toolbar"] > div:last-child > * {
  flex-grow: 0 !important;
}
.Ketcher-root [data-testid="top-toolbar"] hr,
.Ketcher-polymer-editor-root [data-testid="top-toolbar"] hr {
  margin-left: 2px !important;
  margin-right: 2px !important;
}

/* NMRium: Let it use its natural layout */
.nmrium-container {
  position: relative !important;
  z-index: 2 !important; /* ensure NMR UI sits above any stray overlays */
  pointer-events: auto !important;
}

/* Ensure NMRium takes full container size */
.nmrium-container > div {
  width: 100% !important;
  height: 100% !important;
}

/* Hide Ketcher-branded elements (logo/title) - NOT in polymer editor: nav/scroll arrows may use Ketcher in aria-label */
.Ketcher-root [title*="Ketcher"],
.Ketcher-root [title*="ketcher"],
.Ketcher-root [aria-label*="Ketcher"],
.Ketcher-root [aria-label*="ketcher"] {
  display: none !important;
  visibility: hidden !important;
}

/* Hide Ketcher information, help, and 3D buttons */
.Ketcher-root button[title*="Information"],
.Ketcher-root button[title*="information"],
.Ketcher-root button[aria-label*="Information"],
.Ketcher-root button[aria-label*="information"],
.Ketcher-root button[title*="Info"],
.Ketcher-root button[aria-label*="Info"],
.Ketcher-root button[title*="About"],
.Ketcher-root button[aria-label*="About"],
.Ketcher-root button[title="i"],
.Ketcher-root button[aria-label="i"],
.Ketcher-root button[title*="Help"],
.Ketcher-root button[title*="help"],
.Ketcher-root button[aria-label*="Help"],
.Ketcher-root button[aria-label*="help"],
.Ketcher-root button[title="?"],
.Ketcher-root button[aria-label="?"],
.Ketcher-root button[title*="3D"],
.Ketcher-root button[title*="3d"],
.Ketcher-root button[aria-label*="3D"],
.Ketcher-root button[aria-label*="3d"],
/* Hide Functional Groups (creates disconnected structures until Ketcher fix) */
.Ketcher-root button[title*="Functional Groups"],
.Ketcher-root button[title*="functional groups"],
.Ketcher-root button[aria-label*="Functional Groups"],
.Ketcher-root button[aria-label*="functional groups"],
.Ketcher-polymer-editor-root button[title*="Functional Groups"],
.Ketcher-polymer-editor-root button[aria-label*="Functional Groups"],
/* Macromolecules mode: same buttons in polymer editor */
.Ketcher-polymer-editor-root button[title*="Information"],
.Ketcher-polymer-editor-root button[title*="information"],
.Ketcher-polymer-editor-root button[aria-label*="Information"],
.Ketcher-polymer-editor-root button[aria-label*="information"],
.Ketcher-polymer-editor-root button[title*="Info"],
.Ketcher-polymer-editor-root button[title*="About"],
.Ketcher-polymer-editor-root button[aria-label*="About"],
.Ketcher-polymer-editor-root button[title="i"],
.Ketcher-polymer-editor-root button[aria-label="i"],
.Ketcher-polymer-editor-root button[title*="Help"],
.Ketcher-polymer-editor-root button[title*="help"],
.Ketcher-polymer-editor-root button[aria-label*="Help"],
.Ketcher-polymer-editor-root button[aria-label*="help"],
.Ketcher-polymer-editor-root button[title="?"],
.Ketcher-polymer-editor-root button[aria-label="?"],
.Ketcher-polymer-editor-root button[title*="3D"],
.Ketcher-polymer-editor-root button[title*="3d"],
.Ketcher-polymer-editor-root button[aria-label*="3D"],
.Ketcher-polymer-editor-root button[aria-label*="3d"] {
  display: none !important;
  visibility: hidden !important;
}

/* Block Ketcher About/FAQ/Info modal - white cover to match app (molecules + macromolecules) */
.Ketcher-root [role="dialog"]:has(a[href*="epam.com"]),
.Ketcher-root [role="dialog"]:has(a[href*="ketcher"]),
.Ketcher-root [role="dialog"]:has([data-testid="build-version"]),
.Ketcher-root .bp6-dialog:has(a[href*="epam.com"]),
.Ketcher-root .bp6-dialog:has(a[href*="ketcher"]),
.Ketcher-root [class*="Dialog"]:has(a[href*="epam.com"]),
.Ketcher-root [class*="dialog"]:has(a[href*="epam.com"]),
.Ketcher-polymer-editor-root [role="dialog"]:has(a[href*="epam.com"]),
.Ketcher-polymer-editor-root [role="dialog"]:has(a[href*="ketcher"]),
.Ketcher-polymer-editor-root [role="dialog"]:has([data-testid="build-version"]),
.Ketcher-polymer-editor-root .bp6-dialog:has(a[href*="epam.com"]),
.Ketcher-polymer-editor-root .bp6-dialog:has(a[href*="ketcher"]),
.Ketcher-polymer-editor-root [class*="Dialog"]:has(a[href*="epam.com"]),
.Ketcher-polymer-editor-root [class*="dialog"]:has(a[href*="epam.com"]) {
  background: #fff !important;
  box-shadow: none !important;
}
.Ketcher-root [role="dialog"]:has(a[href*="epam.com"]) *,
.Ketcher-root [role="dialog"]:has(a[href*="ketcher"]) *,
.Ketcher-root .bp6-dialog:has(a[href*="epam.com"]) *,
.Ketcher-root .bp6-dialog:has(a[href*="ketcher"]) *,
.Ketcher-polymer-editor-root [role="dialog"]:has(a[href*="epam.com"]) *,
.Ketcher-polymer-editor-root [role="dialog"]:has(a[href*="ketcher"]) *,
.Ketcher-polymer-editor-root .bp6-dialog:has(a[href*="epam.com"]) *,
.Ketcher-polymer-editor-root .bp6-dialog:has(a[href*="ketcher"]) * {
  visibility: hidden !important;
}

/* Hide all Ketcher/EPAM links and version info anywhere in Ketcher */
.Ketcher-root a[href*="epam.com"],
.Ketcher-root a[href*="lifescience.opensource"],
.Ketcher-root [data-testid="build-version"],
.Ketcher-root .headerContent a[href*="ketcher"],
.Ketcher-polymer-editor-root a[href*="epam.com"],
.Ketcher-polymer-editor-root a[href*="ketcher"],
.Ketcher-polymer-editor-root [data-testid="build-version"] {
  display: none !important;
  visibility: hidden !important;
  pointer-events: none !important;
}

/* Ketcher About/FAQ modal in portal - white cover (macromolecules modal may render at body) */
body [role="dialog"]:has(a[href*="epam.com"]),
body [role="dialog"]:has(a[href*="ketcher"]),
body [role="dialog"]:has(a[href*="lifescience.opensource"]),
body .bp6-dialog:has(a[href*="epam.com"]),
body .bp6-dialog:has(a[href*="ketcher"]),
body .bp6-dialog:has(a[href*="lifescience.opensource"]) {
  background: #fff !important;
  box-shadow: none !important;
  pointer-events: none !important;
}
body [role="dialog"]:has(a[href*="epam.com"]) *,
body [role="dialog"]:has(a[href*="ketcher"]) *,
body [role="dialog"]:has(a[href*="lifescience.opensource"]) *,
body .bp6-dialog:has(a[href*="epam.com"]) *,
body .bp6-dialog:has(a[href*="ketcher"]) *,
body .bp6-dialog:has(a[href*="lifescience.opensource"]) * {
  visibility: hidden !important;
}
body .bp6-overlay:has(a[href*="epam.com"]),
body .bp6-overlay:has(a[href*="ketcher"]),
body .bp6-overlay:has(a[href*="lifescience.opensource"]) {
  background: #fff !important;
  backdrop-filter: none !important;
}
body .bp6-overlay:has(a[href*="epam.com"]) .bp6-dialog,
body .bp6-overlay:has(a[href*="epam.com"]) [role="dialog"],
body .bp6-overlay:has(a[href*="ketcher"]) .bp6-dialog,
body .bp6-overlay:has(a[href*="ketcher"]) [role="dialog"],
body .bp6-overlay:has(a[href*="lifescience.opensource"]) .bp6-dialog,
body .bp6-overlay:has(a[href*="lifescience.opensource"]) [role="dialog"] {
  background: #fff !important;
  border: none !important;
}

/* Ensure our app header stays above Ketcher */
.MuiAppBar-root {
  z-index: 9999 !important;
  position: fixed !important;
  pointer-events: none !important; /* Allow clicks to pass through to content below */
  height: 56px !important; /* Ensure it doesn't extend beyond its intended height */
}

/* Re-enable pointer events for interactive elements inside the AppBar */
.MuiAppBar-root * {
  pointer-events: auto !important;
}

/* Do NOT add margin-top to Ketcher - it's inside a container already below the header.
   Adding margin here caused double offset and layout shift when switching modes. */

/* Ensure NMRium can receive keyboard events and clicks */
.nmrium-container,
.nmrium-container * {
  pointer-events: auto !important;
  z-index: 10 !important; /* Above help system */
}

/* Fix main-wrapper blocking clicks - ensure it passes through */
#main-wrapper {
  pointer-events: none !important;
}

/* Cover ONLY the NMRium logo/info button (i icon) with white circle */
.nmrium-container button#logo {
  position: relative !important;
  pointer-events: none !important;
  color: transparent !important;
  background: #fff !important;
  border-radius: 50% !important;
  z-index: 10000 !important;
  overflow: visible !important;
}

.nmrium-container button#logo * {
  visibility: hidden !important;
}

.nmrium-container button#logo::after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 18px;
  height: 18px;
  background: #fff;
  border-radius: 50%;
  border: 1px solid rgba(0,0,0,0.1);
  box-shadow: 0 0 0 1px rgba(255,255,255,0.9);
  z-index: 10001;
}

/* Fix tooltip z-index only - let NMRium handle styling */
.nmrium-container [role="tooltip"],
.nmrium-container .bp6-tooltip,
.nmrium-container .bp6-popover {
  z-index: 50000 !important;
  pointer-events: none !important;
}

/* Hide tooltips ONLY for the covered logo button */
.nmrium-container button#logo[title] {
  pointer-events: none !important;
}

.nmrium-container button#logo:hover::before,
.nmrium-container button#logo:hover::after {
  display: none !important;
}

/* Fix dialog z-index only - let NMRium handle styling */
.nmrium-container .bp6-dialog,
.nmrium-container .bp6-overlay,
.nmrium-container [role="dialog"] {
  z-index: 1000 !important;
}

/* Hide user manual and tutorial icons by targeting the Toolbar.Item */
.nmrium-container button#user-manual,
.nmrium-container [id="user-manual"] {
  display: none !important;
  visibility: hidden !important;
}

/* Position keyboard shortcuts in header above spectrum area */
#nmr-shortcuts-overlay {
  position: absolute !important;
  top: 8px !important;
  left: -295px !important;
  right: auto !important;
  transform: none !important;
  z-index: 100 !important;
  pointer-events: none !important;
}

/* Ensure shortcuts are visible without background */
#nmr-shortcuts-display {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}

/* Custom CSS overrides removed to match official NMRium website appearance */
/* If needed, add minimal styling here without overriding NMRium defaults */


/* Focus visible styles for keyboard navigation */
:focus-visible {
  outline: 2px solid #667eea;
  outline-offset: 2px;
}

/* Remove outline for mouse users (keeps it for keyboard) */
:focus:not(:focus-visible) {
  outline: none;
}

/* Reduce motion for users who prefer it */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* High contrast mode support */
[data-theme="highContrast"] {
  /* Ensure all text has high contrast */
  --text-color: #ffffff;
  --bg-color: #000000;
  --border-color: #ffffff;
}

[data-theme="highContrast"] * {
  border-width: 2px !important;
}

/* Reduce motion when setting is enabled */
[data-reduce-motion="true"] * {
  animation: none !important;
  transition: none !important;
}

/* Screen reader only text */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/* GlChemDraw app dialogs - ensure visible (exclude from Ketcher modal hiding) */
[data-glchemdraw-dialog],
[data-glchemdraw-dialog] * {
  visibility: visible !important;
}

/* Ensure proper focus for interactive elements */
button, a, input, select, textarea {
  &:focus-visible {
    outline: 2px solid #667eea;
    outline-offset: 2px;
  }
}

/* Live region for screen reader announcements */
.live-region {
  position: absolute;
  left: -10000px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

