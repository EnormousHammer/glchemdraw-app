/**
 * Global Styles with Accessibility Support
 */

/* NO desktop-specific overrides - desktop should match web exactly */

/* Ketcher Canvas: Proper sizing to fit under header */
.Ketcher-root {
  height: 100% !important;
  max-height: calc(100vh - 56px) !important; /* Account for 56px header */
  display: flex !important;
  flex-direction: column !important;
  overflow: hidden !important;
}

/* Canvas area takes available space */
.Ketcher-root .canvas-container,
.Ketcher-root [class*="editor"] {
  flex: 1 1 auto !important;
  min-height: 0 !important;
  overflow: auto !important;
}

/* Bottom toolbar stays at natural position */
.Ketcher-root [class*="bottom"],
.Ketcher-root [class*="Bottom"] {
  flex: 0 0 auto !important;
}

/* Issue 1: Restore bottom toolbar after moleculesâ†”macromolecules mode switch.
   Ketcher bug: toolbar disappears when switching back to molecules.
   Target bottom-toolbar (ring templates + Structure Library button). */
.Ketcher-root [data-testid="bottom-toolbar"] {
  display: flex !important;
  visibility: visible !important;
  opacity: 1 !important;
  min-height: 48px !important;
  flex: 0 0 auto !important;
}

/* NMRium: Let it use its natural layout */
.nmrium-container {
  position: relative !important;
  z-index: 2 !important; /* ensure NMR UI sits above any stray overlays */
  pointer-events: auto !important;
}

/* Ensure NMRium takes full container size */
.nmrium-container > div {
  width: 100% !important;
  height: 100% !important;
}

/* Hide any Ketcher-branded elements (title/aria-label) */
.Ketcher-root [title*="Ketcher"],
.Ketcher-root [title*="ketcher"],
.Ketcher-root [aria-label*="Ketcher"],
.Ketcher-root [aria-label*="ketcher"] {
  display: none !important;
  visibility: hidden !important;
}

/* Hide Ketcher information, help, and 3D buttons */
.Ketcher-root button[title*="Information"],
.Ketcher-root button[title*="information"],
.Ketcher-root button[aria-label*="Information"],
.Ketcher-root button[aria-label*="information"],
/* common alternates seen in Ketcher builds */
.Ketcher-root button[title*="Info"],
.Ketcher-root button[aria-label*="Info"],
.Ketcher-root button[title*="About"],
.Ketcher-root button[aria-label*="About"],
.Ketcher-root button[title="i"],
.Ketcher-root button[aria-label="i"],
/* Hide help/question mark button */
.Ketcher-root button[title*="Help"],
.Ketcher-root button[title*="help"],
.Ketcher-root button[aria-label*="Help"],
.Ketcher-root button[aria-label*="help"],
.Ketcher-root button[title="?"],
.Ketcher-root button[aria-label="?"],
/* Hide 3D button */
.Ketcher-root button[title*="3D"],
.Ketcher-root button[title*="3d"],
.Ketcher-root button[aria-label*="3D"],
.Ketcher-root button[aria-label*="3d"] {
  display: none !important;
  visibility: hidden !important;
}

/* Ensure our app header stays above Ketcher */
.MuiAppBar-root {
  z-index: 9999 !important;
  position: fixed !important;
  pointer-events: none !important; /* Allow clicks to pass through to content below */
  height: 56px !important; /* Ensure it doesn't extend beyond its intended height */
}

/* Re-enable pointer events for interactive elements inside the AppBar */
.MuiAppBar-root * {
  pointer-events: auto !important;
}

/* Prevent Ketcher from taking over the top area */
.Ketcher-root {
  margin-top: 56px !important;
  height: calc(100vh - 56px) !important;
}

/* Ensure NMRium can receive keyboard events and clicks */
.nmrium-container,
.nmrium-container * {
  pointer-events: auto !important;
  z-index: 10 !important; /* Above help system */
}

/* Fix main-wrapper blocking clicks - ensure it passes through */
#main-wrapper {
  pointer-events: none !important;
}

/* Cover ONLY the NMRium logo/info button (i icon) with white circle */
.nmrium-container button#logo {
  position: relative !important;
  pointer-events: none !important;
  color: transparent !important;
  background: #fff !important;
  border-radius: 50% !important;
  z-index: 10000 !important;
  overflow: visible !important;
}

.nmrium-container button#logo * {
  visibility: hidden !important;
}

.nmrium-container button#logo::after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 18px;
  height: 18px;
  background: #fff;
  border-radius: 50%;
  border: 1px solid rgba(0,0,0,0.1);
  box-shadow: 0 0 0 1px rgba(255,255,255,0.9);
  z-index: 10001;
}

/* Fix tooltip z-index only - let NMRium handle styling */
.nmrium-container [role="tooltip"],
.nmrium-container .bp6-tooltip,
.nmrium-container .bp6-popover {
  z-index: 50000 !important;
  pointer-events: none !important;
}

/* Hide tooltips ONLY for the covered logo button */
.nmrium-container button#logo[title] {
  pointer-events: none !important;
}

.nmrium-container button#logo:hover::before,
.nmrium-container button#logo:hover::after {
  display: none !important;
}

/* Fix dialog z-index only - let NMRium handle styling */
.nmrium-container .bp6-dialog,
.nmrium-container .bp6-overlay,
.nmrium-container [role="dialog"] {
  z-index: 1000 !important;
}

/* Hide user manual and tutorial icons by targeting the Toolbar.Item */
.nmrium-container button#user-manual,
.nmrium-container [id="user-manual"] {
  display: none !important;
  visibility: hidden !important;
}

/* Position keyboard shortcuts in header above spectrum area */
#nmr-shortcuts-overlay {
  position: absolute !important;
  top: 8px !important;
  left: -295px !important;
  right: auto !important;
  transform: none !important;
  z-index: 100 !important;
  pointer-events: none !important;
}

/* Ensure shortcuts are visible without background */
#nmr-shortcuts-display {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}

/* Custom CSS overrides removed to match official NMRium website appearance */
/* If needed, add minimal styling here without overriding NMRium defaults */


/* Focus visible styles for keyboard navigation */
:focus-visible {
  outline: 2px solid #667eea;
  outline-offset: 2px;
}

/* Remove outline for mouse users (keeps it for keyboard) */
:focus:not(:focus-visible) {
  outline: none;
}

/* Reduce motion for users who prefer it */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* High contrast mode support */
[data-theme="highContrast"] {
  /* Ensure all text has high contrast */
  --text-color: #ffffff;
  --bg-color: #000000;
  --border-color: #ffffff;
}

[data-theme="highContrast"] * {
  border-width: 2px !important;
}

/* Reduce motion when setting is enabled */
[data-reduce-motion="true"] * {
  animation: none !important;
  transition: none !important;
}

/* Screen reader only text */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/* Ensure proper focus for interactive elements */
button, a, input, select, textarea {
  &:focus-visible {
    outline: 2px solid #667eea;
    outline-offset: 2px;
  }
}

/* Live region for screen reader announcements */
.live-region {
  position: absolute;
  left: -10000px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

